{% extends 'ebbings/base.html' %}
{% load staticfiles %}

{% block head %}
<script type="text/javascript">
function validateForm() {
    var username = $('#username')[0].value;
    var teacher_id = $('#teacher_id')[0].value;
    $.ajax({
        url: '{% url 'u_register_teacher_check' %}',
        data: {username: username, teacher_id: teacher_id},
        success: function(jsonresponse) {
            if (jsonresponse.username_exists === true) {
                alert("Username already exists");
            }
            if (jsonresponse.teacher_id_exists === true) {
                alert("Teacher ID already exists");
            }
            if ((jsonresponse.username_exists === false) && (jsonresponse.teacher_id_exists === false)) {
                document.register_teacher.submit();
            }
        }
    });
    return false;
}
</script>
{% endblock %}

{% block content %}
<h1>Users registration page</h1>

<form action="{% url 'u_register_teacher_success' %}" name="register_teacher" onsubmit="return validateForm()" method="POST">
    {% csrf_token %}
    <h2>
        First name
        <input type='text' name='first_name' required><br>
        Last name
        <input type='text' name='last_name' required><br>
        Teacher ID (Students will see this)
        <input type='text' id="teacher_id" name='teacher_id' required><br>
        Email address
        <input type='email' name='email' required><br>
        Username
        <input type='text' id="username" name='username' required><br>
        Password
        <input type='password' name='password' required><br>
        <input type='submit' name='button' value='Create new user'>
    </h2>
</form>
{% endblock %}